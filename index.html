<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Sushi Fox ‚Äî –º–µ–Ω—é</title>
<link rel="icon" href="images/favicon.png" type="image/x-icon" />
<style>
:root{
  --bg:#2a2a2a;
  --accent:#f0630c;
  --muted:#98a0aa;
  --radius:14px;
  --shadow:0 12px 30px rgba(2,6,23,.45);
}
*{box-sizing:border-box}
html,body{margin:0;padding:0;font-family:Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial; background:radial-gradient(900px 400px at -10% -10%, #ffeef6 0%, transparent 0%), radial-gradient(900px 500px at 110% -10%, #e8f7ff 0%, transparent 0%), var(--bg); color:#e6eef6; min-height:100dvh; -webkit-font-smoothing:antialiased;}
.container{max-width:1100px;margin:0 auto;padding:20px}
.header{display:flex;align-items:center;gap:12px;margin-bottom:18px}
.logo{width:56px;height:56px;border-radius:12px;background:url('images/323231231.png') center/cover no-repeat;box-shadow:var(--shadow)}
h1{margin:0;font-size:22px;color:var(--accent)}
.subtitle{color:var(--muted);font-size:13px}
.tabs{display:flex;gap:10px;flex-wrap:wrap;margin:18px 0}
.tab{padding:10px 14px;border-radius:999px;background:#fff;font-weight:600;color:#111;cursor:pointer;box-shadow:0 6px 18px rgba(0,0,0,.08)}
.tab.active{background:linear-gradient(120deg,var(--accent),#ffb347);color:#fff}
.section{background:transparent;border-radius:var(--radius)}

/* Slider for product images */
.slider-container{max-width:420px;margin:0 auto;border-radius:var(--radius);overflow:hidden;background:#fff;box-shadow:var(--shadow)}
.slider-container img#mainSlide{width:100%;height:260px;object-fit:cover;display:block}
.slide{display:none}
.slide.active{display:block}
.slide img{width:100%;height:260px;object-fit:cover;display:block}
.thumbs-row{display:flex;align-items:center;gap:8px;margin-top:8px;justify-content:center;padding:8px}
#thumbs{display:flex;gap:6px;overflow:hidden}
#thumbs img{height:60px;width:100px;object-fit:cover;border-radius:10px;opacity:.65;cursor:pointer;transition:all .18s;border:2px solid transparent}
#thumbs img.active{opacity:1;box-shadow:0 0 0 3px rgba(255,153,0,.12);transform:translateY(-2px);border-color:var(--accent)}

/* Products grid */
.products{display:grid;grid-template-columns:repeat(4,1fr);gap:14px;margin-top:14px}
@media(max-width:980px){.products{grid-template-columns:repeat(3,1fr)}}
@media(max-width:720px){.products{grid-template-columns:repeat(2,1fr)}}
@media(max-width:460px){.products{grid-template-columns:repeat(1,1fr)}}

/* Card */
.card{
  background:#fff;
  border-radius:12px;
  overflow:hidden;
  box-shadow:0 10px 30px rgba(2,6,23,.06);
  display:flex;
  flex-direction:column;
  transition:transform .18s;
}
.card:hover{transform:translateY(-6px)}
.card-img{width:100%;height:160px;object-fit:cover;cursor:pointer}
.card-body{padding:12px;display:flex;flex-direction:column;gap:8px}
.card-title{font-weight:700;color:#0b1220;display:flex;align-items:center;gap:8px}
.card-desc{font-size:13px;color:var(--accent);min-height:36px}
.card-row{display:flex;align-items:center;justify-content:space-between;gap:8px}
.price{font-weight:700;color:var(--accent)}

/* Badge styles */
.badge { display:inline-block; padding:4px 8px; font-size:12px; border-radius:999px; font-weight:700; line-height:1; }
.badge-popular { background:#ff4d4f; color:#fff; }
.badge-new { background:#ffb347; color:#111; border:1px solid rgba(0,0,0,0.04); }

/* Buttons */
.btn{background:linear-gradient(120deg,var(--accent),#ffb347);color:#fff;padding:8px 12px;border-radius:10px;border:none;cursor:pointer;font-weight:700}
.btn:active{transform:translateY(1px)}

/* Cart FAB (–ø–ª–∞–≤–∞—é—â–∞—è –∫–Ω–æ–ø–∫–∞) */
/* ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω—ã cursor, user-select –∏ touch-action –¥–ª—è –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏—è */
.cart-fab{
  position:fixed;
  right:18px;
  bottom:18px;
  width:64px;
  height:64px;
  border-radius:18px;
  background:linear-gradient(120deg,var(--accent),#ffb347);
  display:grid;
  place-items:center;
  color:#fff;
  font-weight:800;
  font-size:22px;
  cursor:grab;
  user-select:none;
  touch-action:none; /* –≤–∞–∂–Ω–æ –¥–ª—è pointer events */
  box-shadow:var(--shadow);
  z-index:1101;
}
.cart-fab:active{ cursor:grabbing; }
.cart-count{position:absolute;top:-6px;right:-6px;background:#071023;color:#fff;border-radius:999px;padding:3px 7px;font-size:12px}

/* ========== SLIDE-IN CART PANEL ========== */
#cartOverlay{
  position:fixed; inset:0; background:rgba(2,6,23,.45);
  opacity:0; visibility:hidden; transition:opacity .25s;
  z-index:1100;
}
#cartOverlay.active{ opacity:1; visibility:visible; }

#cartPanel{
  position:fixed; top:0; right:-420px; width:380px; max-width:92vw; height:100%;
  background:#fff; color:#0b1220; box-shadow:-30px 0 60px rgba(2,6,23,.35);
  border-left: 1px solid rgba(0,0,0,.04);
  z-index:1101; transition:right .32s cubic-bezier(.2,.9,.2,1);
  display:flex; flex-direction:column; padding:18px; gap:12px;
}
#cartPanel.active{ right:0; }

#cartPanel .panel-header{ display:flex; align-items:center; justify-content:space-between; gap:8px; }
#cartPanel h3{ margin:0; color:var(--accent); font-size:18px; }
#cartPanel .close-btn{ background:none;border:none;font-size:20px;cursor:pointer;color:#333; }

#cartPanelItems{ display:flex; flex-direction:column; gap:10px; overflow:auto; padding-right:6px; flex:1; }
.cart-panel-item{
  display:flex; gap:10px; align-items:center; background:#fbfbfb; padding:8px; border-radius:10px;
}
.cart-panel-item img{ width:60px; height:60px; object-fit:cover; border-radius:8px; }
.cart-panel-item .meta{ flex:1; }
.cart-panel-item .meta .name{ font-weight:700; color:var(--accent); margin-bottom:6px; }
.cart-panel-item .meta .qty{ color:var(--muted); font-size:13px; }
.cart-panel-item .meta .price{ font-weight:800; color:var(--accent); margin-top:6px; }

.cart-panel-controls{ display:flex; align-items:center; gap:8px; margin-top:6px; justify-content:flex-end; }

#cartPanelFooter{ border-top:1px solid #eee; padding-top:12px; display:flex; flex-direction:column; gap:8px; }
#cartPanelFooter .total-row{ display:flex; justify-content:space-between; align-items:center; font-weight:900; font-size:18px; color:var(--accent); }
#cartPanelFooter .btn-checkout{ width:100%; padding:10px 12px; border-radius:10px; border:none; cursor:pointer; font-weight:800; }

/* make panel responsive */
@media(max-width:520px){
  #cartPanel{ width:100%; right:-100%; }
  #cartPanel.active{ right:0; }
}

/* Modal / sheet (—Å—Ç–∞—Ä—ã–π —Å—Ç–∏–ª—å –æ—Å—Ç–∞–≤–ª–µ–Ω –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏, –Ω–æ –º—ã –µ–≥–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º) */
.modal{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(2,6,23,.45);z-index:80;padding:16px}
.modal.open{display:flex}
.sheet{width:min(980px,100%);max-height:92vh;overflow:auto;background:#fff;border-radius:14px;padding:12px;box-shadow:0 30px 60px rgba(2,6,23,.3);position:relative}
.close-x{position:absolute;right:12px;top:10px;cursor:pointer;font-size:20px}
.sheet-grid{display:grid;grid-template-columns:1fr 340px;gap:12px}
@media(max-width:900px){.sheet-grid{grid-template-columns:1fr}}
.cart-list{display:flex;flex-direction:column;gap:10px;padding:6px}

/* Cart text classes */
.cart-name{font-weight:700;color:var(--accent)}
.cart-qty{color:var(--muted)}
.cart-total{font-weight:700;color:var(--accent)}

.qty{display:flex;align-items:center;gap:6px}
.icon-btn{padding:6px;border-radius:8px;border:none;background:#f0f0f0;cursor:pointer}
.summary{background:#fafafa;border-radius:10px;padding:12px;display:flex;flex-direction:column;gap:10px}
.input{width:100%;padding:10px;border-radius:8px;border:1px solid #e7e7e7}

/* Mini lightbox */
#miniLightboxImg{position:fixed;border-radius:12px;box-shadow:0 20px 50px rgba(2,6,23,.5);cursor:pointer;transition:transform .35s ease, opacity .2s ease;will-change:transform;z-index:200;display:none}

/* Cart text override for modal */
.sheet h3 { color: #000 !important; }
.sheet label { color: #000 !important; font-weight:600; }
#orderResult { color:#000 !important; font-weight:700; }
.sheet .total, .sheet .total span, #cartTotal { color:#000 !important; font-weight:800; }
#cartList .cart-name, #cartList .cart-qty, #cartList .cart-total, .cart-total, .cart-name { color:#000 !important; }

/* Visual upgrade: cards, slider, etc (kept) */
.tab { font-size: 14px; transition: transform .18s, box-shadow .18s; }
.tab:hover { transform: translateY(-2px); box-shadow:0 6px 18px rgba(0,0,0,.12); }
.card { transition: transform .25s ease, box-shadow .25s ease; }
.card:hover { transform: translateY(-8px) scale(1.02); box-shadow:0 20px 40px rgba(0,0,0,.12); }
.card-title { font-size: 16px; line-height:1.3; }
.card-desc { font-size:13px; line-height:1.4; }
.add-btn { font-size:13px; padding:6px 10px; }
.slider-container { border-radius:18px; overflow:hidden; box-shadow:0 20px 60px rgba(0,0,0,.15); }
.slide img { transition: transform .35s ease; }
.slide.active img { transform: scale(1.02); }
#thumbs img { border:2px solid transparent; }
#thumbs img.active { border-color: var(--accent); transform: translateY(-4px); }

/* Skeleton / fly-to-cart (kept) */
.card.skeleton { background:#eee; color:transparent; pointer-events:none; min-height:220px; }
.card.skeleton .card-img { background:#ddd; height:160px; }
.fly-to-cart { position:fixed; z-index:9999; transition: transform 0.6s cubic-bezier(0.5,-0.5,0.5,1.5), opacity .4s; pointer-events:none; border-radius:12px; width:80px; height:80px; object-fit:cover; }

/* ----------------------------
  CATEGORY SLIDER (inside menu) ‚Äî STICKY behavior
-----------------------------*/

/* tabs-slider: STICKY ‚Äî when it reaches top it stays visible at top;
   when you scroll back up above its original spot it returns to place */
.tabs-slider{
  position: sticky;
  top: 0; /* –ø—Ä–∏–ª–∏–ø–∞–µ—Ç –∫ —Å–∞–º–æ–º—É –≤–µ—Ä—Ö—É –æ–∫–Ω–∞ */
  z-index: 999; /* —á—Ç–æ–±—ã —Ç–æ—á–Ω–æ –ø–æ–≤–µ—Ä—Ö –∫–æ–Ω—Ç–µ–Ω—Ç–∞ */
  display:flex;
  align-items:center;
  gap:8px;
  margin: 0;
  padding: 8px 6px;
  background: transparent;
  border-radius: var(--radius);
}

/* track */
.tabs-track{
  display:flex;
  gap:10px;
  overflow-x:auto;
  scroll-behavior:smooth;
  -ms-overflow-style:none;
  scrollbar-width:none;
  flex:1 1 auto;
  padding:2px 8px;
}
.tabs-track::-webkit-scrollbar{ display:none; }

/* arrows */
.tabs-arrow{ background:#fff; border:none; border-radius:999px; width:36px; height:36px; display:grid; place-items:center; cursor:pointer; box-shadow:0 6px 18px rgba(0,0,0,.08); font-size:18px; }
.tabs-arrow:active{ transform:scale(.98); }

/* inside menu view we give the track a bg to match page bg and rounded pill */
#menuView .tabs-track{
  background: var(--bg);
  border-radius: 12px;
  padding: 8px;
}

/* make tabs not wrap inside track */
.tabs-track .tab{ white-space:nowrap; flex:0 0 auto; }

/* ================== –ö–û–ù–¢–ê–ö–¢–ò (–ù–û–í–´–ô –°–¢–ò–õ–¨) ================== */
.contacts {
  border-radius:18px;
  padding:24px;
  gap:24px;
  box-shadow:0 20px 40px rgba(0,0,0,.15);
  display:flex;
  align-items:flex-start;
  flex-wrap:wrap;
  color:var(--accent);
  font-size:15px;
  line-height:1.5;
}

/* left column: infos + form */
.contact-left{
  flex:1;
  min-width:300px;
  display:flex;
  flex-direction:column;
  gap:20px;
}

.contact-info h3{
  font-size:18px;
  margin:0 0 8px 0;
  color:var(--accent);
}

.contact-row{
  color:var(--accent);
  font-weight:600;
}

.contact-row a{
  color:var(--accent);
  text-decoration:none;
}

.contact-row a:hover{
  text-decoration:underline;
}

/* ================== –§–û–†–ú–ê –ó–í–û–†–û–¢–ù–û–ì–û –ó–í'–Ø–ó–ö–£ ================== */
.contact-form{
  background:#2a2a2a;
  padding:16px;
  border-radius:18px;
  display:flex;
  flex-direction:column;
  gap:12px;
  box-shadow:0 12px 30px rgba(2,6,23,.3);
}

.contact-form h4{
  margin:0 0 6px 0;
  font-size:16px;
  color:var(--accent);
  font-weight:700;
}

.contact-form .input{
  background:#fff;
  color:#111;
  border-radius:12px;
  padding:10px 12px;
  border:none;
  font-size:14px;
  width:100%;
  box-shadow:0 6px 18px rgba(0,0,0,.08);
  transition:all .18s;
}

.contact-form .input:focus{
  outline:none;
  box-shadow:0 6px 18px rgba(255,153,0,.45);
  transform:translateY(-2px);
}

.contact-form button{
  background:linear-gradient(120deg,var(--accent),#ffb347);
  color:#fff;
  font-weight:700;
  font-size:14px;
  border:none;
  border-radius:12px;
  padding:10px 0;
  cursor:pointer;
  transition:all .18s;
}

.contact-form button:hover{
  box-shadow:0 12px 30px rgba(255,153,0,.45);
  transform:translateY(-2px);
}

#feedbackResult{
  color:var(--accent);
  font-weight:700;
  font-size:14px;
  margin-top:6px;
}

/* Responsive: map below text on small screens */
@media(max-width:900px){
  .contacts { flex-direction:column; }
  .map { order:2; width:100%; min-height:200px; }
  .contact-left { order:1; width:100%; }
}

/* ================== RANDOM VIEW ADJUSTMENTS ================== */
/* –¶–µ–Ω—Ç—Ä–∏—Ä—É–µ–º –≤—Å—é —Å–µ–∫—Ü–∏—é —Ä–∞–Ω–¥–æ–º–∞ –∏ –¥–µ–ª–∞–µ–º –∫–∞—Ä—Ç–æ—á–∫—É —à–∏—Ä–µ, –∫–∞—Ä—Ç–∏–Ω–∫–∞ –ù–ï –æ–±—Ä–µ–∑–∞–µ—Ç—Å—è —Å–∏–ª—å–Ω–æ */
#randomView { display:flex; align-items:center; justify-content:center; padding:28px; min-height:60vh; }
#randomView .random-inner { width:100%; max-width:900px; display:flex; flex-direction:column; align-items:center; gap:18px; }
#randomView .random-controls { display:flex; gap:12px; align-items:center; flex-wrap:wrap; justify-content:center; }
#randomView .random-note { color:var(--muted); font-size:14px; }
#randomContainer { width:100%; display:flex; align-items:center; justify-content:center; margin-top:6px; }

/* –∫–∞—Ä—Ç–æ—á–∫–∞ —Ä–∞–Ω–¥–æ–º–Ω–æ–≥–æ –±–ª—é–¥–∞ ‚Äî —à–∏—Ä–µ –∏ —Å –±–æ–ª–µ–µ –≤—ã—Å–æ–∫–∏–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º */
#randomContainer .card { max-width:620px; width:100%; margin:0; }
#randomContainer .card-img { height:320px; object-fit:contain; background:#fafafa; display:block; }

/* –ø—Ä–∏ –º–æ–±–∏–ª—å–Ω–æ–º ‚Äî —á—É—Ç—å —É–º–µ–Ω—å—à–∞—Ç—å –≤—ã—Å–æ—Ç—É –∫–∞—Ä—Ç–∏–Ω–∫–∏ */
@media(max-width:720px){
  #randomContainer .card-img { height:220px; }
  #randomView { min-height:50vh; padding:16px; }
  #randomContainer .card { padding:0; }
}
/* Search input minor styling */
#menuSearch {
  width:100%;
  padding:10px 12px;
  border-radius:10px;
  border:1px solid rgba(255,255,255,0.08);
  background:rgba(255,255,255,0.06);
  color:var(--muted);
  font-size:15px;
  margin:16px 0;
}
#menuSearch::placeholder { color: rgba(230,238,246,0.5); }
</style>
</head>
<body>
<div class="container">
  <div class="header">
    <div style="display:flex;align-items:center;gap:12px">
      <div class="logo" aria-hidden="true"></div>
      <div>
        <h1>Sushi Fox</h1>
        <div class="subtitle">–î–æ—Å—Ç–∞–≤–∫–∞: —Å—É—à—ñ, –Ω–∞–ø–æ—ó, –±—É—Ä–≥–µ—Ä–∏, —Å–∞–ª–∞—Ç–∏</div>
      </div>
    </div>
  </div>

  <!-- NAVBAR SPA -->
  <div class="tabs" id="mainTabs" aria-label="–ù–∞–≤—ñ–≥–∞—Ü—ñ—è">
    <div class="tab active" data-view="home">–ì–æ–ª–æ–≤–Ω–∞</div>
    <div class="tab" data-view="menu">–ú–µ–Ω—é</div>
    <div class="tab" data-view="random">üé≤ –†–∞–Ω–¥–æ–º–Ω–µ –±–ª—é–¥–æ</div>
    <div class="tab" data-view="contacts">–ö–æ–Ω—Ç–∞–∫—Ç–∏</div>
  </div>

  <!-- SPA CONTENT -->
  <div id="spaContent">
    <div id="homeView" class="spa-view" style="display:block;padding:20px;text-align:center;">
      <h2>–õ–∞—Å–∫–∞–≤–æ –ø—Ä–æ—Å–∏–º–æ –¥–æ Sushi Fox!</h2>
      <p>–î–æ—Å—Ç–∞–≤–∫–∞ —Å—É—à—ñ, –Ω–∞–ø–æ—ó–≤, –±—É—Ä–≥–µ—Ä—ñ–≤ —Ç–∞ —Å–∞–ª–∞—Ç—ñ–≤ –ø—Ä—è–º–æ –¥–æ –≤–∞—à–æ–≥–æ –¥–æ–º—É.</p>
      <img src="images/15.gif" alt="Sushi Fox" style="max-width:100%;border-radius:18px;box-shadow:var(--shadow);margin-top:12px">
    </div>

    <div id="menuView" class="spa-view" style="display:none;">
      <!-- CATEGORY SLIDER (inside menu view) -->
      <div class="tabs-slider" aria-hidden="false">
        <button class="tabs-arrow left" id="catPrev" aria-label="–ù–∞–∑–∞–¥">‚ùÆ</button>
        <div id="tabs" class="tabs-track" aria-label="–ö–∞—Ç–µ–≥–æ—Ä—ñ—ó" role="tablist"></div>
        <button class="tabs-arrow right" id="catNext" aria-label="–í–ø–µ—Ä–µ–¥">‚ùØ</button>
      </div>

      <div class="section">
        <div class="slider-container" id="sliderBlock">
          <!-- –ó–∞–º–µ–Ω–µ–Ω–æ –Ω–∞ –≥–ª–æ–±–∞–ª—å–Ω—ã–π —Å–ª–∞–π–¥–µ—Ä: –≥–ª–∞–≤–Ω—ã–π —Å–ª–∞–π–¥ + –º–∏–Ω–∏–∞—Ç—é—Ä—ã -->
          <img id="mainSlide" src="images/slide1.jpg" alt="Slide" />
          <div class="thumbs-row">
            <div id="thumbs" aria-hidden="true"></div>
          </div>
        </div>
      </div>

      <!-- SEARCH: –¥–æ–±–∞–≤–ª–µ–Ω–æ –ø–µ—Ä–µ–¥ –ø—Ä–æ–¥—É–∫—Ç–∞–º–∏ -->
      <div class="section">
        <input id="menuSearch" placeholder="–ü–æ—à—É–∫ –ø–æ –º–µ–Ω—é (–Ω–∞–∑–≤–∞, –æ–ø–∏—Å, ID)..." aria-label="–ü–æ—à—É–∫ –ø–æ –º–µ–Ω—é" />
      </div>

      <div class="section">
        <div id="products" class="products" aria-live="polite"></div>
      </div>
    </div>

    <!-- ===== Random view (—Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π) ===== -->
    <div id="randomView" class="spa-view" style="display:none;">
      <div class="random-inner">
        <h2>üé≤ –†–∞–Ω–¥–æ–º–Ω–µ –±–ª—é–¥–æ</h2>
        <div class="random-controls" role="region" aria-label="Random controls">
          <button id="randomBtn" class="btn">–ó–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ —Ä–∞–Ω–¥–æ–º–Ω–µ –±–ª—é–¥–æ</button>
          <div id="randomNote" class="random-note">–ë–µ—Ä–µ –≤–∏–ø–∞–¥–∫–æ–≤–∏–π —Ç–æ–≤–∞—Ä —ñ–∑ —É—Å—å–æ–≥–æ –º–µ–Ω—é Poster</div>
        </div>
        <div id="randomContainer"></div>
      </div>
    </div>

    <div id="contactsView" class="spa-view" style="display:none;">
      <!-- –ö–æ–Ω—Ç–∞–∫—Ç—ã -->
      <div class="contacts">
        <div class="contact-left">
          <div class="contact-info">
            <h3 style="margin-top:0">–ö–æ–Ω—Ç–∞–∫—Ç–∏</h3>
            <div class="contact-row">üìû –¢–µ–ª–µ—Ñ–æ–Ω: <a class="link" href="tel:+380662714304">+38 (066) 271-43-04</a></div>
            <div class="contact-row">üïò –ß–∞—Å —Ä–æ–±–æ—Ç–∏: 10:00 ‚Äî 22:00</div>
            <div class="contact-row">üìç –ê–¥—Ä–µ—Å–∞: –í–æ–ª—å–Ω–æ–≥–æ—Ä—Å—å–∫, –±—É–ª—å–≤–∞—Ä –ú–∏—Ä—É 15</div>
            <div class="contact-row">üì∏ Instagram: <a class="link" href="https://www.instagram.com/sushi_fox_volnohorsk/" target="_blank">@sushi_fox_volnohorsk</a></div>
            <div class="contact-row">‚úàÔ∏è Telegram: <a class="link" href="https://t.me/SanyaSushist" target="_blank">SanyaSushist</a></div>
            <div class="contact-row">‚úâÔ∏è Email: <a class="link" href="mailto:contact@sushi-fox.ua">contact@sushi-fox.ua</a></div>
          </div>

          <!-- Netlify form: –∑–∞–º–µ–Ω–∏–ª —Å—Ç–∞—Ä—É—é –ª–æ–∫–∞–ª—å–Ω—É—é —Ñ–æ—Ä–º—É –Ω–∞ —ç—Ç—É -->
          <form id="feedbackForm" class="contact-form" name="feedback" method="POST" data-netlify="true" netlify-honeypot="bot-field" aria-label="–§–æ—Ä–º–∞ –∑–≤–æ—Ä–æ—Ç–Ω–æ–≥–æ –∑–≤'—è–∑–∫—É">
            <!-- —Å–∫—Ä—ã—Ç–æ–µ –ø–æ–ª–µ –¥–ª—è Netlify -->
            <input type="hidden" name="form-name" value="feedback" />
            <p style="display:none">
              <label>Don‚Äôt fill this out: <input name="bot-field" /></label>
            </p>

            <h4>–ó–≤–æ—Ä–æ—Ç–Ω—ñ–π –∑–≤'—è–∑–æ–∫</h4>
            <input id="fbName" name="name" class="input" placeholder="–í–∞—à–µ —ñ–º'—è" required />
            <input id="fbPhone" name="phone" class="input" placeholder="–ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω—É" type="tel" required />
            <textarea id="fbMessage" name="message" class="input" placeholder="–ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è" rows="4" required></textarea>
            <button type="submit">–ù–∞–¥—ñ—Å–ª–∞—Ç–∏</button>
            <div id="feedbackResult" role="status" aria-live="polite"></div>
          </form>

        </div>

        <div class="map">
          <iframe id="contactMap" src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d2604.4893619324837!2d34.0087415!3d48.4757868!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x40da4a14a7640001%3A0xf601f29d7836a3b!2z0JvQu9C40L7Qu9C10L3QuNC90LjRgtC10YDQtdC70Yw!5e0!3m2!1suk!2sua!4v1695037185269!5m2!1suk!2sua" width="100%" height="100%" style="border:0;" allowfullscreen="" loading="lazy"></iframe>
          <div style="position:relative;margin-top:10px;text-align:center">
            <a href="https://www.google.com/maps/search/?api=1&query=%D0%92%D0%BE%D0%BB%D1%8C%D0%BD%D0%BE%D0%B3%D0%BE%D1%80%D1%81%D1%8C%D0%BA+%D0%B1%D1%83%D0%BB%D1%8C%D0%B2%D0%B0%D1%80+%D0%9C%D0%B8%D1%80%D1%83+15" target="_blank" rel="noopener" class="btn" style="display:inline-block;margin-top:8px;padding:8px 12px">–í—ñ–¥–∫—Ä–∏—Ç–∏ –≤ Google Maps</a>
          </div>
        </div>
      </div>
    </div>

  </div>
</div>

<!-- Cart FAB (–ø–ª–∞–≤–∞—é—â–∞—è –∫–Ω–æ–ø–∫–∞) -->
<div class="cart-fab" id="openCart" title="–ö–æ—à–∏–∫">üõí<div class="cart-count" id="cartCount">0</div></div>

<!-- SLIDE-IN CART PANEL + OVERLAY -->
<div id="cartOverlay" aria-hidden="true"></div>

<aside id="cartPanel" aria-hidden="true" role="dialog" aria-label="–ö–æ—à–∏–∫">
  <div class="panel-header">
    <h3>–í–∞—à–µ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è</h3>
    <button class="close-btn" id="cartPanelClose" title="–ó–∞–∫—Ä–∏—Ç–∏">‚úï</button>
  </div>

  <div id="cartPanelItems" aria-live="polite">
    <!-- –≠–ª–µ–º–µ–Ω—Ç—ã –∫–æ—Ä–∑–∏–Ω—ã –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —Å—é–¥–∞ -->
  </div>

  <div id="cartPanelFooter">
    <div style="display:flex;gap:8px;flex-direction:column">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <span style="color:#666">–†–∞–∑–æ–º</span>
        <span id="cartPanelTotal" style="font-weight:900;color:var(--accent)">0‚Ç¥</span>
      </div>

      <!-- === –ó–¥–µ—Å—å –¥–æ–±–∞–≤–ª–µ–Ω—ã –ø–æ–ª—è: –ò–º—è, –¢–µ–ª–µ—Ñ–æ–Ω, –ê–¥—Ä–µ—Å, –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π === -->
      <div style="display:flex;flex-direction:column;gap:8px;margin-top:6px">
        <input id="custName" class="input" placeholder="–Ü–º'—è *" />
        <input id="custPhone" class="input" placeholder="–¢–µ–ª–µ—Ñ–æ–Ω *" />
        <input id="custAddr" class="input" placeholder="–ê–¥—Ä–µ—Å–∞ (–≤—É–ª–∏—Ü—è, –±—É–¥., –ø—ñ–¥'—ó–∑–¥)" />
        <textarea id="custNote" class="input" placeholder="–ö–æ–º–µ–Ω—Ç–∞—Ä –¥–æ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è" rows="3"></textarea>
      </div>

      <!-- –û—Å—Ç–∞–≤–ª—è–µ–º —Ñ–æ—Ä–º—É/–∫–Ω–æ–ø–∫–∏ –∑–∞–∫–∞–∑–∞ –≤ –ø–∞–Ω–µ–ª–µ (–Ω–æ –æ—Å–Ω–æ–≤–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π checkoutOrder id) -->
      <button id="checkoutOrder" class="btn btn-checkout" style="background:linear-gradient(120deg,var(--accent),#ffb347);color:#fff">–û—Ñ–æ—Ä–º–∏—Ç–∏ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è</button>
      <div id="orderResult" style="font-weight:700;margin-top:8px;color:#333"></div>
    </div>
  </div>
</aside>

<!-- Mini lightbox clone -->
<img id="miniLightboxImg" alt="" />

<script>
/* ========== SPA –Ω–∞–≤–∏–≥–∞—Ü–∏—è (–Ω–µ –º–µ–Ω—è–µ—Ç –ª–æ–≥–∏–∫—É, –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç views) ========== */
(function initSPA(){
  const mainTabs = document.querySelectorAll('#mainTabs .tab');
  const views = {
    home: document.getElementById('homeView'),
    menu: document.getElementById('menuView'),
    random: document.getElementById('randomView'),
    contacts: document.getElementById('contactsView')
  };
  mainTabs.forEach(tab => {
    tab.addEventListener('click', ()=>{
      mainTabs.forEach(t=>t.classList.remove('active'));
      tab.classList.add('active');
      const view = tab.getAttribute('data-view');
      Object.keys(views).forEach(v => { views[v].style.display = (v===view ? 'block' : 'none'); });
      // –µ—Å–ª–∏ –ø–æ–∫–∞–∑–∞–ª–∏ –º–µ–Ω—é ‚Äî –∑–∞—Ö–æ—Ç–∏–º –ø–µ—Ä–µ—Ä–µ–Ω–¥–µ—Ä–∏—Ç—å/–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å–ª–∞–π–¥–µ—Ä (–µ—Å–ª–∏ —É–∂–µ –∑–∞–≥—Ä—É–∂–µ–Ω–æ)
      if(view === 'menu') {
        try { if(typeof renderSlider === 'function') renderSlider(window.lastRenderedProducts); } catch(e){ /* –ø—É—Å—Ç–æ */ }
        setTimeout(updateCategoryArrows, 120);
      }
      // –µ—Å–ª–∏ –æ—Ç–∫—Ä—ã–ª–∏ —Ä–∞–Ω–¥–æ–º ‚Äî –Ω–∏—á–µ–≥–æ –æ—Å–æ–±–æ–≥–æ –Ω–µ –Ω—É–∂–Ω–æ (–¥–∞–Ω–Ω—ã–µ –ø–æ–¥–≥—Ä—É–∂–∞—é—Ç—Å—è –≥–ª–æ–±–∞–ª—å–Ω–æ)
    });
  });
})();

/* ========== –¢–û–¢ –ñ–ï JS (—Å —Ñ–∏–ª—å—Ç—Ä–æ–º –∫–∞—Ç–µ–≥–æ—Ä–∏–π) ========== */
/* ========== –ö–û–ù–§–Ü–ì ========== */
const MENU_API = '/.netlify/functions/menu';
const ORDER_API = '/.netlify/functions/order';
const LIQPAY_API = '/.netlify/functions/liqpay';
const IMG_FALLBACK = '/images/noimage.png';

/* ====== GLOBAL SLIDER IMAGES ====== */
/* –¢—É—Ç –¥–æ–±–∞–≤–ª—è–π —Å–≤–æ–∏ —Ñ–æ—Ç–æ –¥–ª—è –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ —Å–ª–∞–π–¥–µ—Ä–∞.
   –ü—É—Ç—å ‚Äî –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–æ–µ–∫—Ç–∞, –Ω–∞–ø—Ä–∏–º–µ—Ä: "images/slide1.jpg" */
const slidesImages = [
  "images/slide1.jpg",
  "images/slide2.jpg",
  "images/slide3.jpg"
];

/* ====== GLOBAL SLIDER IMPLEMENTATION ====== */
/* (—ç—Ç–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å–æ–≤–º–µ—Å—Ç–∏–º–∞ —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ –≤—ã–∑–æ–≤–∞–º–∏ renderSlider(prods)) */
let sliderInterval = null;
let sliderIndex = 0;

function renderSlider(/* products ignored ‚Äî global slider */){
  const main = document.getElementById('mainSlide');
  const thumbsContainer = document.getElementById('thumbs');
  if(!main || !thumbsContainer) return;

  // –µ—Å–ª–∏ —Å–ª–∞–π–¥—ã –Ω–µ –∑–∞–¥–∞–Ω—ã ‚Äî fallback
  const slides = Array.isArray(slidesImages) && slidesImages.length ? slidesImages : ["images/placeholder1.jpg"];

  // –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ–º –∏–Ω–¥–µ–∫—Å
  if(sliderIndex >= slides.length) sliderIndex = 0;
  if(sliderIndex < 0) sliderIndex = 0;

  // –≥–ª–∞–≤–Ω—ã–π —Å–ª–∞–π–¥
  main.src = slides[sliderIndex];

  // –º–∏–Ω–∏–∞—Ç—é—Ä—ã
  thumbsContainer.innerHTML = '';
  slides.forEach((src, i) => {
    const img = document.createElement('img');
    img.src = src;
    img.alt = 'thumb-' + i;
    if(i === sliderIndex) img.classList.add('active');
    img.addEventListener('click', (e)=> {
      sliderIndex = i;
      updateMainSlide();
      resetSliderInterval();
    });
    thumbsContainer.appendChild(img);
  });

  // lightbox –¥–ª—è main –∏ –º–∏–Ω–∏–∞—Ç—é—Ä
  initSliderLightbox();

  // –∞–≤—Ç–æ–ø—Ä–æ–∫—Ä—É—Ç–∫–∞ 10 —Å–µ–∫—É–Ω–¥
  resetSliderInterval();
}

function updateMainSlide(){
  const main = document.getElementById('mainSlide');
  const thumbs = document.querySelectorAll('#thumbs img');
  const slides = Array.isArray(slidesImages) && slidesImages.length ? slidesImages : ["images/placeholder1.jpg"];
  if(!main) return;
  sliderIndex = ((sliderIndex % slides.length) + slides.length) % slides.length;
  main.src = slides[sliderIndex];
  thumbs.forEach((t,i)=> t.classList.toggle('active', i === sliderIndex));
}

function resetSliderInterval(){
  if(sliderInterval) clearInterval(sliderInterval);
  sliderInterval = setInterval(()=>{
    const slides = Array.isArray(slidesImages) && slidesImages.length ? slidesImages : ["images/placeholder1.jpg"];
    sliderIndex = (sliderIndex + 1) % slides.length;
    updateMainSlide();
  }, 10000); // 10 000 ms = 10 s
}

function initSliderLightbox(){
  // main image lightbox
  const main = document.getElementById('mainSlide');
  if(main){
    main.onclick = ()=> openLightbox(main);
  }
  // thumbs lightbox
  document.querySelectorAll('#thumbs img').forEach(img=>{
    img.onclick = ()=> openLightbox(img);
  });
}

/* ========== BADGE CONFIG ========== */
const popularIds = ['87','88']; // –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã
const newIds = ['86','88','85','87'];     // –Ω–æ–≤–∏–Ω–∫–∏

/* ========== –°–¢–ï–ô–¢ ========== */
let allProducts = [];
let categories = [];
let currentCategory = null;
let cart = JSON.parse(localStorage.getItem('sushi_cart') || '[]');

/* ========== –£–¢–ò–õ–Ü–¢–ò ========== */
function formatUAH(n){ return Math.round(n) + '‚Ç¥'; }
function safeImg(url){ return url ? url : IMG_FALLBACK; }
function escapeHtml(s){ if(!s) return ''; return String(s).replace(/[&<>"']/g, (m)=> ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m])); }

function getProductId(p){
  return String(p.id || p.product_id || p.name || '');
}

function getBadgesHtml(p){
  try {
    const id = getProductId(p);
    const badges = [];
    const popularNormalized = popularIds.map(String);
    const newNormalized = newIds.map(String);
    if(popularNormalized.includes(id)) badges.push('<span class="badge badge-popular" aria-hidden="true">üî• –ü–æ–ø—É–ª—è—Ä–Ω–µ</span>');
    if(newNormalized.includes(id)) badges.push('<span class="badge badge-new" aria-hidden="true">‚≠ê –ù–æ–≤–∏–Ω–∫–∞</span>');
    return badges.join(' ');
  } catch(e){
    return '';
  }
}

/* ========== –ó–ê–í–ê–ù–¢–ê–ñ–ï–ù–ù–Ø –ú–ï–ù–Æ ========== */
async function loadMenu(){
  try{
    const res = await fetch(MENU_API);
    if(!res.ok) throw new Error('–ù–µ –≤–¥–∞–ª–æ—Å—è –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –º–µ–Ω—é –∑ —Å–µ—Ä–≤–µ—Ä–∞');
    const data = await res.json();

    if (data?.products && Array.isArray(data.products)) {
      allProducts = data.products;

      const rawCategories = Array.isArray(data.categories) && data.categories.length
        ? data.categories
        : Array.from(new Set(allProducts.map(p=>p.category || '–Ü–Ω—à–µ')));

      // –§–ò–õ–¨–¢–†: —É–±–∏—Ä–∞–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –±–µ–∑ —Ç–æ–≤–∞—Ä–æ–≤ —Å —Ü–µ–Ω–æ–π > 0, –Ω–æ –æ—Å—Ç–∞–≤–ª—è–µ–º "–ö–æ–º–ø–ª–µ–∫—Ç–∞—Ü—ñ—è"
      categories = rawCategories.filter(cat=>{
        try {
          const norm = String(cat).trim().toLowerCase();
          if(norm === '–∫–æ–º–ø–ª–µ–∫—Ç–∞—Ü—ñ—è') return true;
          return allProducts.some(p => {
            const pCat = (p.category || '–Ü–Ω—à–µ');
            return String(pCat) === String(cat) && Number(p.price) > 0;
          });
        } catch(e) { return false; }
      });

      if(!categories.length){
        const nonZeroCats = Array.from(new Set(allProducts.filter(p=>Number(p.price)>0).map(p=>p.category || '–Ü–Ω—à–µ')));
        categories = nonZeroCats.length ? nonZeroCats : Array.from(new Set(allProducts.map(p=>p.category || '–Ü–Ω—à–µ')));
      }

    } else {
      allProducts = [];
      categories = [];
      console.warn('menu: –æ—Ç—Ä–∏–º–∞–Ω–æ –ø–æ—Ä–æ–∂–Ωi –¥–∞–Ω—ñ');
    }
    renderCategories();

    if(categories.length){
      if(!currentCategory || !categories.includes(currentCategory)){
        showCategory(categories[0]);
      } else {
        showCategory(currentCategory);
      }
    } else {
      document.getElementById('products').innerHTML = '<div style="padding:20px;color:var(--muted)">–ú–µ–Ω—é –ø–æ—Ä–æ–∂–Ω—î</div>';
    }

    setTimeout(updateCategoryArrows, 120);
  } catch(err){
    console.error('loadMenu error', err);
    document.getElementById('products').innerHTML = `<div style="padding:20px;color:var(--muted)">–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ –º–µ–Ω—é</div>`;
  }
}

/* ========== ORDERED CATEGORIES (–ø—Ä–∏–º–µ—Ä: —Ç—ã –¥–æ–±–∞–≤–ª—è–µ—à—å —Å—é–¥–∞ –ø–æ—Ä—è–¥–æ–∫ –ø–æ id) ========== */
/* –î–æ–±–∞–≤—å —Å—é–¥–∞ –Ω—É–∂–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ –¥–ª—è –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏.
   –ö–ª—é—á ‚Äî —Ç–æ—á–Ω–æ–µ –∏–º—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (–∫–∞–∫ –ø—Ä–∏—Ö–æ–¥–∏—Ç –≤ data.categories / p.category).
   –ó–Ω–∞—á–µ–Ω–∏–µ ‚Äî –º–∞—Å—Å–∏–≤ id-—Å—Ç—Ä–æ–∫ –≤ —Ç–æ–º –ø–æ—Ä—è–¥–∫–µ, –≤ –∫–æ—Ç–æ—Ä–æ–º —Ç—ã —Ö–æ—á–µ—à—å –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å —Ç–æ–≤–∞—Ä—ã.
*/
const categoryOrder = {
  // –ø—Ä–∏–º–µ—Ä (–∑–∞–º–µ–Ω–∏ –Ω–∞ —Å–≤–æ–∏ id'—à–∫–∏)
  "–°–µ—Ç–∏": ["98","110","113","119","122","124","129","132","137","140","141","146","151","152","158","159","160","161"],
  "–§—ñ—Ä–º–æ–≤—ñ –î—Ä–∞–∫–æ–Ω–∏": ["85","86","87","88"],
  "–ö–ª–∞—Å–∏—á–Ω—ñ —Ä–æ–ª–∏": ["9","46","50","54","55","59","60","65","66","69","70","71","72","73","74","75","76","80"],
  "–ú–∞–∫—ñ —Ä–æ–ª–∏": ["13","14","15","16","17","18","19","20","21","23","28","29","30","31","32"],
  "–§—É—Ç–æ–º–∞–∫—ñ": ["33","34","35","36"],
  "Fox —Ä–æ–ª–∏ (—Ñ—ñ—Ä–º–æ–≤—ñ)": ["53","56","57","58","61","62","63","64","67","68","77","78","79","81","82","83","84"],
  "–¢–µ–ø–ª—ñ —Ä–æ–ª–∏": ["12","91","92","93","94","95","96","97"],
  "–°–µ–∑–∞–º —Ä–æ–ª–∏": ["43","44","45"],
  "–°—É—à—ñ": ["37","38","39","40","41","42"]
};

/* helper to apply explicit order inside a category */
function applyCategoryOrder(products, categoryName){
  try {
    const orderArr = Array.isArray(categoryOrder[categoryName]) ? categoryOrder[categoryName].map(String) : null;
    if(!orderArr || !orderArr.length) return products; // –Ω–µ—Ç —è–≤–Ω–æ–≥–æ –ø–æ—Ä—è–¥–∫–∞ ‚Äî –≤–µ—Ä–Ω—É—Ç—å –∫–∞–∫ –µ—Å—Ç—å

    // –°–¥–µ–ª–∞–µ–º –±—ã—Å—Ç—Ä—ã–π –ø–æ–∏—Å–∫: id -> product
    const remaining = products.slice(); // –∫–æ–ø–∏—è –≤ –∏—Å—Ö–æ–¥–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ
    const ordered = [];

    orderArr.forEach(id => {
      for(let i = 0; i < remaining.length; i++){
        if(getProductId(remaining[i]) === String(id)){
          ordered.push(remaining[i]);
          remaining.splice(i,1);
          i--; // —Å–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–µ–º –∏–Ω–¥–µ–∫—Å –ø–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è
        }
      }
    });

    return ordered.concat(remaining);
  } catch(e){
    console.warn('applyCategoryOrder error', e);
    return products;
  }
}

/* ========== –ö–ê–¢–ï–ì–û–†–Ü–á ========== */
function renderCategories(){
  const tabs = document.getElementById('tabs'); 
  if(!tabs) return; 
  tabs.innerHTML='';

  categories
    .filter(cat => cat !== "–©–æ —Ç—Ä–µ–±–∞ —Ä–µ–∫–æ–º–µ–Ω–¥—É–≤–∞—Ç–∏ —Ç–∞ –∑–Ω–∏–∂–∫–∏!") // üî• —É–±–∏—Ä–∞–µ–º –ª–∏—à–Ω—é—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é
    .forEach(cat=>{
      const el = document.createElement('div'); 
      el.className='tab'; 
      el.textContent = cat;
      el.onclick = ()=> showCategory(cat);
      tabs.appendChild(el);
    });

  updateCategoryArrows();
}

/* ========== –ü–û–ö–ê–ó –ö–ê–¢–ï–ì–û–†–Ü–á ========== */
function showCategory(cat){
  currentCategory = cat;
  document.querySelectorAll('#tabs .tab').forEach(t=> 
    t.classList.toggle('active', t.textContent===cat)
  );

  let prods = allProducts.filter(p => (p.category || '–Ü–Ω—à–µ') === cat);

  prods = applyCategoryOrder(prods, cat);

  renderProducts(prods);
  renderSlider && renderSlider(prods);
  window.lastRenderedProducts = prods;

  // –ø—Ä–∏–º–µ–Ω—è–µ–º —Ñ–∏–ª—å—Ç—Ä –ø–æ–∏—Å–∫–∞ (–µ—Å–ª–∏ –µ—Å—Ç—å)
  applySearchFilter();
}

/* ========== –†–ï–ù–î–ï–† –ü–†–û–î–£–ö–¢–Ü–í ========== */
function renderProducts(products){
  const wrap = document.getElementById('products'); if(!wrap) return; wrap.innerHTML = '';
  if(!products.length){ wrap.innerHTML = '<div style="padding:18px;color:var(--muted)">–ù–µ–º–∞—î —Ç–æ–≤–∞—Ä—ñ–≤ —É —Ü—ñ–π –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó</div>'; return; }
  products.forEach(p=>{
    const card = document.createElement('div'); 
    // –î–æ–±–∞–≤–ª—è–µ–º –∫–ª–∞—Å—Å product-item –∏ data-* –¥–ª—è –ø–æ–∏—Å–∫–∞
    card.className = 'card product-item';
    card.setAttribute('data-name', (p.name||'').toLowerCase());
    card.setAttribute('data-desc', (p.desc||'').toLowerCase());
    card.setAttribute('data-id', String(getProductId(p)));

    const badgesHtml = getBadgesHtml(p);
    card.innerHTML = `
      <img loading="lazy" src="${safeImg(p.img)}" alt="${escapeHtml(p.name)}" class="card-img product-img" />
      <div class="card-body">
        <div class="card-title">
          <span style="flex:1">${escapeHtml(p.name)}</span>
          <span aria-hidden="true">${badgesHtml}</span>
        </div>
        <div class="card-desc">${escapeHtml(p.desc || '')}</div>
        <div class="card-row">
          <div class="price">${formatUAH(p.price)}</div>
          <button class="btn add-btn">–í –∫–æ—à–∏–∫</button>
        </div>
      </div>`;
    card.querySelector('.add-btn').addEventListener('click', ()=> addToCartFromProduct(p));
    wrap.appendChild(card);
  });
  initProductLightbox();

  // –µ—Å–ª–∏ –ø–æ–∏—Å–∫–æ–≤–∞—è —Å—Ç—Ä–æ–∫–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–µ–∫—Å—Ç ‚Äî –ø—Ä–∏–º–µ–Ω–∏–º —Ñ–∏–ª—å—Ç—Ä
  applySearchFilter();
}

/* ========== SEARCH ========== */
function applySearchFilter(){
  const input = document.getElementById('menuSearch');
  if(!input) return;
  const q = (input.value || '').trim().toLowerCase();
  const items = document.querySelectorAll('.product-item');
  if(!q){
    items.forEach(it => { it.style.display = ''; });
    return;
  }
  let anyVisible = false;
  items.forEach(it => {
    const name = it.getAttribute('data-name') || '';
    const desc = it.getAttribute('data-desc') || '';
    const id = it.getAttribute('data-id') || '';
    const match = name.includes(q) || desc.includes(q) || id.includes(q);
    it.style.display = match ? '' : 'none';
    if(match) anyVisible = true;
  });

  // –ï—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ ‚Äî –º–æ–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ (–Ω–µ —É–¥–∞–ª—è–µ—Ç DOM)
  const wrap = document.getElementById('products');
  if(wrap){
    let noneEl = document.getElementById('noSearchResults');
    if(!anyVisible){
      if(!noneEl){
        noneEl = document.createElement('div');
        noneEl.id = 'noSearchResults';
        noneEl.style.padding = '18px';
        noneEl.style.color = 'var(--muted)';
        noneEl.textContent = '–ù—ñ—á–æ–≥–æ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ';
        wrap.appendChild(noneEl);
      }
    } else {
      if(noneEl) noneEl.remove();
    }
  }
}

document.getElementById('menuSearch')?.addEventListener('input', applySearchFilter);

/* ========== –ú–Ü–ù–Ü-–õ–ê–ô–¢–ë–û–ö–° ========== */
function initProductLightbox(){
  document.querySelectorAll('.product-img, #mainSlide, #thumbs img').forEach(img=>{
    img.onclick = ()=> openLightbox(img);
  });
}
function openLightbox(imgEl){
  if(window._miniLb){ window._miniLb.close(); }
  const rect = imgEl.getBoundingClientRect();
  const clone = imgEl.cloneNode();
  clone.id = 'miniLightboxImg';
  clone.style.position='fixed'; clone.style.top=rect.top+'px'; clone.style.left=rect.left+'px';
  clone.style.width=rect.width+'px'; clone.style.height=rect.height+'px';
  clone.style.transition='transform .35s ease, top .35s ease, left .35s ease, width .35s ease, height .35s ease, opacity .2s ease';
  clone.style.transformOrigin='center center'; clone.style.borderRadius='12px'; clone.style.zIndex=9999; clone.style.cursor='pointer'; clone.style.objectFit='cover';
  document.body.appendChild(clone);
  const vw=window.innerWidth,vh=window.innerHeight; const maxW=vw*0.9,maxH=vh*0.9;
  const scale=Math.min(1.8,maxW/rect.width,maxH/rect.height);
  const centerX=rect.left+rect.width/2, centerY=rect.top+rect.height/2;
  const dx=(vw/2)-centerX, dy=(vh/2)-centerY;
  requestAnimationFrame(()=>{ clone.style.transform = `translate(${dx}px, ${dy}px) scale(${scale})`; clone.style.display='block'; });
  function close(){ clone.style.transform='translate(0px, 0px) scale(1)'; setTimeout(()=> { if(clone.parentElement) clone.parentElement.removeChild(clone); }, 350); window._miniLb=null; document.removeEventListener('click', outsideHandler); window.removeEventListener('keydown', keyHandler); }
  function outsideHandler(e){ if(e.target !== clone) close(); }
  function keyHandler(e){ if(e.key === 'Escape') close(); }
  clone.addEventListener('click', close);
  setTimeout(()=>document.addEventListener('click', outsideHandler),0);
  window.addEventListener('keydown', keyHandler);
  window._miniLb = { close };
}

/* ========== –ö–û–®–ò–ö ========== */
function addToCartFromProduct(p){
  const id = p.id || p.product_id || p.name;
  const existing = cart.find(c=>c.id === id);
  if(existing) existing.qty++;
  else cart.push({ id, name: p.name, price: Number(p.price)||0, qty:1, img: p.img || IMG_FALLBACK });
  saveCart(); updateCartUI();
}
function saveCart(){ localStorage.setItem('sushi_cart', JSON.stringify(cart)); }

/* –û–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–π updateCartUI: –æ–±–Ω–æ–≤–ª—è–µ—Ç –ø–∞–Ω–µ–ª—å –∏ –ø–ª–∞–≤–∞—é—â—É—é –∫–Ω–æ–ø–∫—É */
function updateCartUI(){
  // –æ–±–Ω–æ–≤–ª—è–µ–º —Å—á—ë—Ç—á–∏–∫ –Ω–∞ FAB
  if(document.getElementById('cartCount')) document.getElementById('cartCount').textContent = cart.reduce((a,c)=>a+c.qty,0);

  // –æ–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ä—ã–π —Å–ø–∏—Å–æ–∫ (–µ—Å–ª–∏ –µ—Å—Ç—å)
  const listEl = document.getElementById('cartList'); if(listEl) listEl.innerHTML = '';
  cart.forEach((c,i)=>{
    if(listEl){
      const div = document.createElement('div'); div.className = 'cart-item';
      div.innerHTML = `<img src="${safeImg(c.img)}" alt="${escapeHtml(c.name)}"/>
        <div>
          <div class="cart-name">${escapeHtml(c.name)}</div>
          <div class="cart-qty">${formatUAH(c.price)} √ó ${c.qty}</div>
        </div>
        <div style="text-align:right">
          <div class="cart-total">${formatUAH(c.price * c.qty)}</div>
          <div style="margin-top:8px">
            <button class="icon-btn" data-idx="${i}" data-op="-1">‚àí</button>
            <button class="icon-btn" data-idx="${i}" data-op="+1">+</button>
            <button class="icon-btn" data-idx="${i}" data-op="remove" style="margin-left:6px">‚úï</button>
          </div>
        </div>`;
      listEl.appendChild(div);
    }
  });

  // –æ–±–Ω–æ–≤–ª—è–µ–º –ø–∞–Ω–µ–ª—å (–Ω–æ–≤–∞—è)
  const panelItems = document.getElementById('cartPanelItems');
  if(panelItems) panelItems.innerHTML = '';
  cart.forEach((c,i)=>{
    const item = document.createElement('div');
    item.className = 'cart-panel-item';
    item.innerHTML = `
      <img src="${safeImg(c.img)}" alt="${escapeHtml(c.name)}" />
      <div class="meta">
        <div class="name">${escapeHtml(c.name)}</div>
        <div class="qty">${formatUAH(c.price)} √ó ${c.qty}</div>
        <div class="cart-panel-controls">
          <button class="icon-btn" data-idx="${i}" data-op="-1">‚àí</button>
          <button class="icon-btn" data-idx="${i}" data-op="+1">+</button>
          <button class="icon-btn" data-idx="${i}" data-op="remove" style="margin-left:6px">‚úï</button>
        </div>
      </div>
    `;
    panelItems.appendChild(item);
  });

  // –Ω–∞–≤–µ—Å—å event listeners –¥–ª—è –∏–∫–æ–Ω–æ–∫ (–∫–æ–ª-–≤–æ/—É–¥–∞–ª–µ–Ω–∏–µ)
  document.querySelectorAll('.icon-btn').forEach(btn=>{
    btn.onclick = ()=>{
      const idx = Number(btn.getAttribute('data-idx'));
      const op = btn.getAttribute('data-op');
      if(op === 'remove'){ cart.splice(idx,1); }
      else { cart[idx].qty += Number(op); if(cart[idx].qty < 1) cart.splice(idx,1); }
      saveCart(); updateCartUI();
    };
  });

  // –æ–±—â–∞—è —Å—É–º–º–∞ ‚Äî –æ–±–Ω–æ–≤–ª—è–µ–º –≤–µ–∑–¥–µ
  const total = cart.reduce((a,c)=>a + c.price*c.qty,0);
  if(document.getElementById('cartTotal')) document.getElementById('cartTotal').textContent = formatUAH(total);
  if(document.getElementById('cartPanelTotal')) document.getElementById('cartPanelTotal').textContent = formatUAH(total);
}

/* ========== –û–¢–ö–†–´–¢–ò–ï/–ó–ê–ö–†–´–¢–ò–ï –ü–ê–ù–ï–õ–ò ========== */
const cartOverlay = document.getElementById('cartOverlay');
const cartPanel = document.getElementById('cartPanel');
const openCartBtn = document.getElementById('openCart');
const cartPanelClose = document.getElementById('cartPanelClose');

function openCartPanel(){
  cartPanel.classList.add('active');
  cartOverlay.classList.add('active');
  cartPanel.setAttribute('aria-hidden','false');
  cartOverlay.setAttribute('aria-hidden','false');
  document.body.style.overflow = 'hidden';
  // –æ–±–Ω–æ–≤–∏–º UI –ø–µ—Ä–µ–¥ –ø–æ–∫–∞–∑–æ–º
  updateCartUI();
}
function closeCartPanel(){
  cartPanel.classList.remove('active');
  cartOverlay.classList.remove('active');
  cartPanel.setAttribute('aria-hidden','true');
  cartOverlay.setAttribute('aria-hidden','true');
  document.body.style.overflow = '';
}

openCartBtn?.addEventListener('click', openCartPanel);
cartPanelClose?.addEventListener('click', closeCartPanel);
cartOverlay?.addEventListener('click', closeCartPanel);
document.addEventListener('keydown', (e)=> { if(e.key === 'Escape') closeCartPanel(); });

/* ========== –ü–ï–†–ï–¢–ê–°–ö–ò–í–ê–ï–ú–ê–Ø –ö–ù–û–ü–ö–ê –ö–û–†–ó–ò–ù–´ (DRAGGABLE FAB) ========== */
/* –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç localStorage, –∫–æ—Ä–æ—Ç–∫–∞—è, –Ω–∞–¥—ë–∂–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ Pointer Events */
(function makeFabDraggable(){
  const fab = document.getElementById('openCart');
  if(!fab) return;

  let dragging = false;
  let startX = 0, startY = 0;
  let origLeft = 0, origTop = 0;
  let moved = false;

  // pointerdown ‚Äî –Ω–∞—á–∞–ª–æ –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏—è
  fab.addEventListener('pointerdown', function (e) {
    // —Ç–æ–ª—å–∫–æ –ª–µ–≤–æ–π –∫–Ω–æ–ø–∫–æ–π/–∫–∞—Å–∞–Ω–∏–µ–º
    if (e.pointerType === 'mouse' && e.button !== 0) return;
    e.preventDefault();
    fab.setPointerCapture && fab.setPointerCapture(e.pointerId);
    dragging = true;
    moved = false;
    startX = e.clientX;
    startY = e.clientY;
    const rect = fab.getBoundingClientRect();
    origLeft = rect.left;
    origTop = rect.top;
    // —É–±–∏—Ä–∞–µ–º –ø–µ—Ä–µ—Ö–æ–¥—ã —á—Ç–æ–±—ã –ø–æ–∑–∏—Ü–∏—è –¥–≤–∏–≥–∞–ª–∞—Å—å —á—ë—Ç–∫–æ
    fab.style.transition = 'none';
    // —É—Å—Ç–∞–Ω–æ–≤–∏–º explicit left/top, —á—Ç–æ–±—ã –ø–µ—Ä–µ–π—Ç–∏ –æ—Ç right/bottom
    if (!fab.style.left) fab.style.left = rect.left + 'px';
    if (!fab.style.top) fab.style.top = rect.top + 'px';
    // –≤—ã–∫–ª—é—á–∏–º right/bottom —á—Ç–æ–±—ã –Ω–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤–∞–ª–æ
    fab.style.right = 'auto';
    fab.style.bottom = 'auto';
  });

  // pointermove ‚Äî –¥–≤–∏–≥–∞–µ–º
  document.addEventListener('pointermove', function (e) {
    if (!dragging) return;
    e.preventDefault();
    const dx = e.clientX - startX;
    const dy = e.clientY - startY;
    const vw = window.innerWidth;
    const vh = window.innerHeight;
    const w = fab.offsetWidth;
    const h = fab.offsetHeight;
    let left = origLeft + dx;
    let top = origTop + dy;
    // –æ–≥—Ä–∞–Ω–∏—á–∏–º –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –æ–∫–Ω–∞ —Å –æ—Ç—Å—Ç—É–ø–æ–º 8px
    left = Math.max(8, Math.min(left, vw - w - 8));
    top = Math.max(8, Math.min(top, vh - h - 8));
    fab.style.left = left + 'px';
    fab.style.top = top + 'px';
    moved = moved || (Math.hypot(dx, dy) > 3);
  });

  // –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏—è
  function endDrag(e) {
    if (!dragging) return;
    dragging = false;
    try { fab.releasePointerCapture && fab.releasePointerCapture(e && e.pointerId); } catch(err){}
    // –≤–µ—Ä–Ω—É—Ç—å –º–∏–Ω–∏–º–∞–ª—å–Ω—É—é —Ç—Ä–∞–Ω–∑–∏—Ü–∏—é
    fab.style.transition = 'box-shadow .2s';
    // –µ—Å–ª–∏ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–ª–∏ ‚Äî –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç—å –ø–æ—Å–ª–µ–¥—É—é—â–∏–π click
    if (moved) {
      const blocker = function (ev) { ev.stopImmediatePropagation(); ev.preventDefault(); };
      // –¥–æ–±–∞–≤–ª—è–µ–º —Å–ª—É—à–∞—Ç–µ–ª—å –≤ capture, —á—Ç–æ–±—ã –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å click
      fab.addEventListener('click', blocker, true);
      // —É–¥–∞–ª–∏–º –µ–≥–æ —á–µ—Ä–µ–∑ –Ω–µ–±–æ–ª—å—à–æ–π —Ç–∞–π–º–∞—É—Ç (–ø–æ—Å–ª–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è click)
      setTimeout(()=> fab.removeEventListener('click', blocker, true), 300);
    }
  }
  document.addEventListener('pointerup', endDrag);
  document.addEventListener('pointercancel', endDrag);

  // —Ä–µ—Å–∞–π–∑ ‚Äî –µ—Å–ª–∏ –æ–∫–Ω–æ –∏–∑–º–µ–Ω–∏–ª–∞—Å—å, —Å–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–µ–º –ø–æ–∑–∏—Ü–∏—é —á—Ç–æ–±—ã —ç–ª–µ–º–µ–Ω—Ç –Ω–µ –æ–∫–∞–∑–∞–ª—Å—è –≤–Ω–µ —ç–∫—Ä–∞–Ω–∞
  window.addEventListener('resize', function(){
    const vw = window.innerWidth, vh = window.innerHeight;
    const w = fab.offsetWidth, h = fab.offsetHeight;
    const rect = fab.getBoundingClientRect();
    let left = rect.left, top = rect.top;
    left = Math.max(8, Math.min(left, vw - w - 8));
    top = Math.max(8, Math.min(top, vh - h - 8));
    fab.style.left = left + 'px';
    fab.style.top = top + 'px';
  });
})();

/* ========== –û–§–û–†–ú–õ–ï–ù–ò–ï –ó–ê–ú–û–í–õ–ï–ù–ò–Ø ========== */
/* –æ—Å—Ç–∞–≤–∏–ª –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ checkoutOrder ‚Äî –æ–Ω –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–µ–∫—É—â—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é cart –∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç UI */
document.getElementById('checkoutOrder')?.addEventListener('click', async ()=>{
  if(cart.length === 0){ alert('–ö–æ—à–∏–∫ –ø–æ—Ä–æ–∂–Ω—ñ–π'); return; }
  const name = document.getElementById('custName') ? document.getElementById('custName').value.trim() : '';
  const phone = document.getElementById('custPhone') ? document.getElementById('custPhone').value.trim() : '';
  const addr = document.getElementById('custAddr') ? document.getElementById('custAddr').value.trim() : '';
  const note = document.getElementById('custNote') ? document.getElementById('custNote').value.trim() : '';
  const payment = document.querySelector('input[name="payment"]:checked')?.value || 'online';
  if(!name || !phone){
    // –µ—Å–ª–∏ —Ñ–æ—Ä–º–∞ –Ω–µ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤ UI (–º—ã –æ—Ñ–æ—Ä–º–ª—è–µ–º –ø—Ä—è–º–æ –∏–∑ –ø–∞–Ω–µ–ª–∏) ‚Äî –ø–æ–ø—Ä–æ—Å–∏–º –≤–≤–µ—Å—Ç–∏ –º–∏–Ω–∏–º—É–º
    if(!document.getElementById('custName')){
      const n = prompt('–í–∫–∞–∂—ñ—Ç—å –≤–∞—à–µ —ñ–º\'—è');
      const ph = prompt('–í–∫–∞–∂—ñ—Ç—å —Ç–µ–ª–µ—Ñ–æ–Ω');
      if(!n || !ph){ alert('–ü–æ—Ç—Ä—ñ–±–Ω—ñ —ñ–º\'—è —Ç–∞ —Ç–µ–ª–µ—Ñ–æ–Ω'); return; }
    } else {
      alert("–í–∫–∞–∂—ñ—Ç—å —ñ–º'—è —Ç–∞ —Ç–µ–ª–µ—Ñ–æ–Ω"); return;
    }
  }

  const payload = {
    customer: { name, phone, addr, note },
    items: cart.map(c => ({ id: c.id, qty: c.qty, price: c.price })),
    total: cart.reduce((s,x)=> s + x.price * x.qty, 0),
    paymentMethod: payment
  };

  const orderResultEl = document.getElementById('orderResult');
  if(orderResultEl) orderResultEl.textContent = '–ù–∞–¥—Å–∏–ª–∞—î–º–æ...';

  try {
    const res = await fetch(ORDER_API, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(payload)
    });
    if(!res.ok) throw new Error('–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—ñ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è –Ω–∞ Poster');
    const orderRes = await res.json();
    const orderId = orderRes?.id || orderRes?.orderId || null;

    if(!orderId){
      if(orderResultEl) orderResultEl.textContent = '–ó–∞–º–æ–≤–ª–µ–Ω–Ω—è —Å—Ç–≤–æ—Ä–µ–Ω–æ –Ω–∞ Poster, –∞–ª–µ –Ω–µ–≤—ñ–¥–æ–º–∏–π ID';
      return;
    }

    if(payment === 'cash'){
      if(orderResultEl) orderResultEl.textContent = `–ó–∞–º–æ–≤–ª–µ–Ω–Ω—è –ø—Ä–∏–π–Ω—è—Ç–æ ‚Ññ${orderId}`;
      cart = []; saveCart(); updateCartUI();
      setTimeout(()=> closeCartPanel(),1500);
      return;
    }

    if(orderResultEl) orderResultEl.textContent = `–ó–∞–º–æ–≤–ª–µ–Ω–Ω—è —Å—Ç–≤–æ—Ä–µ–Ω–æ ‚Ññ${orderId}. –û–Ω–ª–∞–π–Ω-–æ–ø–ª–∞—Ç–∞ —Ç–∏–º—á–∞—Å–æ–≤–æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞.`;
    cart = []; saveCart(); updateCartUI();

  } catch(err){
    console.error('checkout error', err);
    if(document.getElementById('orderResult')) document.getElementById('orderResult').textContent = '–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –æ—Ñ–æ—Ä–º–ª–µ–Ω–Ω—ñ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è';
  }
});

/* ========== –Ü–ù–Ü–¶–ò–ê–õ–ò–ó–ê–¶–Ü–Ø / –î–û–ü. –õ–û–ì–Ü–ö–ê ========== */

/* ========== CATEGORY SLIDER CONTROLS ========== */
const catPrev = document.getElementById('catPrev');
const catNext = document.getElementById('catNext');
const tabsTrack = document.getElementById('tabs');

function updateCategoryArrows(){
  if(!tabsTrack || !catPrev || !catNext) return;
  if(tabsTrack.scrollWidth <= tabsTrack.clientWidth + 2){
    catPrev.style.display = 'none';
    catNext.style.display = 'none';
  } else {
    catPrev.style.display = '';
    catNext.style.display = '';
  }
}
catPrev?.addEventListener('click', ()=> { if(tabsTrack) tabsTrack.scrollBy({ left: -240, behavior: 'smooth' }); });
catNext?.addEventListener('click', ()=> { if(tabsTrack) tabsTrack.scrollBy({ left: 240, behavior: 'smooth' }); });
tabsTrack?.addEventListener('wheel', (e)=>{
  if(Math.abs(e.deltaY) > Math.abs(e.deltaX)){
    e.preventDefault();
    tabsTrack.scrollLeft += e.deltaY;
  }
});
window.addEventListener('resize', ()=> setTimeout(updateCategoryArrows, 80));

/* Skeleton loader */
function showSkeletons(count = 8){
  try{
    const wrap = document.getElementById('products');
    if(!wrap) return;
    wrap.innerHTML = '';
    for(let i=0;i<count;i++){
      const div = document.createElement('div');
      div.className = 'card skeleton';
      div.innerHTML = `<div class="card-img"></div>
        <div class="card-body">
          <div class="card-title"></div>
          <div class="card-desc"></div>
          <div class="card-row">
            <div class="price"></div>
            <div class="add-btn"></div>
          </div>
        </div>`;
      wrap.appendChild(div);
    }
  }catch(e){}
}
showSkeletons();

/* ========== RANDOM DISH (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç allProducts) ========== */
function renderRandomDishCard(product){
  const container = document.getElementById('randomContainer');
  container.innerHTML = '';
  if(!product){
    container.innerHTML = '<div style="color:var(--muted);padding:12px">–ù–µ–º–∞—î –¥–æ—Å—Ç—É–ø–Ω–∏—Ö —Ç–æ–≤–∞—Ä—ñ–≤ –¥–ª—è –≤–∏–±–æ—Ä—É.</div>';
    return;
  }
  const card = document.createElement('div');
  card.className = 'card';
  card.style.maxWidth = '620px';
  card.style.marginTop = '12px';
  card.innerHTML = `
    <img loading="lazy" src="${safeImg(product.img)}" alt="${escapeHtml(product.name)}" class="card-img" />
    <div class="card-body" style="text-align:center">
      <div class="card-title">${escapeHtml(product.name)}</div>
      <div class="card-desc">${escapeHtml(product.desc || '')}</div>
      <div class="card-row" style="justify-content:center">
        <div class="price">${formatUAH(product.price)}</div>
        <div style="display:flex;gap:8px;margin-left:10px">
          <button class="btn add-random">–í –∫–æ—à–∏–∫</button>
          <button class="btn regen-random" style="background:#fff;color:#111;font-weight:700">–©–µ</button>
        </div>
      </div>
    </div>
  `;
  container.appendChild(card);

  card.querySelector('.add-random').addEventListener('click', ()=>{
    try { addToCartFromProduct(product); } catch(e){ console.error(e); }
    const note = document.getElementById('randomNote');
    if(note){ note.textContent = '–î–æ–¥–∞–Ω–æ –≤ –∫–æ—à–∏–∫ ‚úÖ'; setTimeout(()=> note.textContent = '–ë–µ—Ä–µ –≤–∏–ø–∞–¥–∫–æ–≤–∏–π —Ç–æ–≤–∞—Ä —ñ–∑ —É—Å—å–æ–≥–æ –º–µ–Ω—é Poster', 1200); }
  });

  card.querySelector('.regen-random').addEventListener('click', ()=>{
    showRandomDish();
  });
}

function showRandomDish(){
  if(!allProducts || !allProducts.length){
    const container = document.getElementById('randomContainer');
    container.innerHTML = '<div style="padding:12px;color:var(--muted)">–ú–µ–Ω—é —â–µ –Ω–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ ‚Äî –∑–∞—á–µ–∫–∞–π—Ç–µ...</div>';
    return;
  }
  const idx = Math.floor(Math.random() * allProducts.length);
  const product = allProducts[idx];
  renderRandomDishCard(product);
}

// –ø—Ä–∏–≤—è–∑–∫–∞ –∫–Ω–æ–ø–∫–∏
document.getElementById('randomBtn')?.addEventListener('click', ()=>{
  showRandomDish();
});

/* ========== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ========== */
updateCategoryArrows();
updateCartUI();
loadMenu();
setTimeout(updateCategoryArrows, 500);
</script>
</body>
</html>
